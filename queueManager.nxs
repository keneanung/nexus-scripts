{"name":"QueueManager","enabled":true,"description":"A queue manager for Iron Realms Nexus 3","type":"group","items":[{"name":"onLoad","id":2,"type":"function","enabled":true,"code":"!function(){var e={972:function(e,t,r){\"use strict\";var n=r(600),o=n(r(100)),u=n(r(870));Object.defineProperty(t,\"__esModule\",{value:!0}),t.QueueManager=void 0;var a=r(226),s=function(e,t){var r=Object.keys(e);return r.length===Object.keys(t).length&&r.every((function(r){return e[r]===t[r]}))},l=[{letter:\"e\",property:\"haveEq\"},{letter:\"b\",property:\"haveBalance\"},{letter:\"c\",property:\"haveClassBalance\"},{letter:\"s\",property:\"haveShipBalance\"},{letter:\"p\",property:\"haveParalysis\"},{letter:\"w\",property:\"beBound\"},{letter:\"u\",property:\"beStanding\"},{letter:\"t\",property:\"beStunned\"}],i={equilibrium:\"e\",balance:\"b\",class:\"c\",paralysis:\"!p\",unbound:\"!w\",stun:\"!t\",free:\"be!p!t\",freestand:\"be!p!tu\",full:\"be!p!tuc\"},c=function(){function e(){var t=this;(0,o.default)(this,e),this.queue=[],this.localUnsyncedItems=[],this.getQueue=function(){return t.queue},this.clear=function(e){if(\"all\"!==e)for(var r=t.parseQueue(e),n=t.queue.length-1;n>=0;n--)s(r,t.queue[n].properties)&&t.queue.splice(n,1);else t.queue=[]},this.trackFirst=function(e,r){var n=t.parseQueue(r);t.queue.unshift({command:e,properties:n,locallyControlled:!1,repeat:!1})},this.trackAt=function(e,r,n){var o=t.parseQueue(n);t.queue.splice(e-1,0,{command:r,properties:o,locallyControlled:!1,repeat:!1})},this.trackReplace=function(e,r,n){var o=t.parseQueue(n);t.queue.splice(e-1,1,{command:r,properties:o,locallyControlled:!1,repeat:!1})},this.trackRemove=function(e){t.queue.splice(e-1,1)},this.run=function(e,r){var n,o=t.parseQueue(r),u=t.removeRunCommand(e,o,!0);u||(u=t.removeRunCommand(e,o,!1)),null!=(n=u)&&n.repeat&&t.localUnsyncedItems.push(Object.assign({},u,{repeat:!0,queueing:!1})),t.sendLocalCommands()},this.do=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.localUnsyncedItems.push({command:e,properties:r,queueing:!1,repeat:n}),t.sendLocalCommands()},this.sendLocalCommands=function(){for(var e=0;t.queue.length+e<6&&e<t.localUnsyncedItems.length;){var r=t.localUnsyncedItems[e];if(e++,!r.queueing){var n=t.translateItemProperties(r.properties);(0,a.sendCommand)(`queue add ${n} ${r.command}`),r.queueing=!0}}},this.translateItemProperties=function(e){var t=\"\";for(var r of l){var n=e[r.property];void 0!==n&&(t+=(n?\"\":\"!\")+r.letter)}return t},this.blocked=function(){var e=t.localUnsyncedItems.find((function(e){return e.queueing}));void 0!==e&&(e.queueing=!1)}}return(0,u.default)(e,[{key:\"track\",value:function(e,t){var r,n,o=this.parseQueue(t),u=this.localUnsyncedItems.findIndex((function(t){return t.command===e&&s(t.properties,o)})),a=void 0;u>-1&&(a=this.localUnsyncedItems[u],this.localUnsyncedItems.splice(u,1)),this.queue.push({command:e,properties:o,locallyControlled:u>-1,repeat:null!=(r=null==(n=a)?void 0:n.repeat)&&r})}},{key:\"parseQueue\",value:function(e){return e=this.translateDefaultQueues(e),this.translateQueueLettersToProperties(e)}},{key:\"translateDefaultQueues\",value:function(e){var t;return null!=(t=i[e])?t:e}},{key:\"translateQueueLettersToProperties\",value:function(e){var t={};for(var r of l){var n=e.indexOf(r.letter);if(n>-1){var o=0===n||\"!\"!==e.at(n-1);t[r.property]=o}}return t}},{key:\"removeRunCommand\",value:function(e,t,r){for(var n=0;n<this.queue.length;n++){var o=this.queue[n];if(o.command.toLowerCase()==e.toLowerCase()&&(!r||s(o.properties,t)))return this.queue.splice(n,1),o}}}]),e}();t.QueueManager=c},226:function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.sendCommand=void 0,t.sendCommand=function(e){nexusclient.send_commands(e,!1)}},100:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")},e.exports.__esModule=!0,e.exports.default=e.exports},870:function(e,t,r){var n=r(739);function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,\"value\"in o&&(o.writable=!0),Object.defineProperty(e,n(o.key),o)}}e.exports=function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,\"prototype\",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},600:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},64:function(e,t,r){var n=r(425).default;e.exports=function(e,t){if(\"object\"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||\"default\");if(\"object\"!==n(o))return o;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},739:function(e,t,r){var n=r(425).default,o=r(64);e.exports=function(e){var t=o(e,\"string\");return\"symbol\"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},425:function(e){function t(r){return e.exports=t=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var u=t[n]={exports:{}};return e[n](u,u.exports,r),u.exports}var n={};!function(){\"use strict\";var e=n,t=r(972);console.log(\"loading Queue Manager version 0.0.3...\");var o=new t.QueueManager;globalThis.queueManager=o,console.log(\"Queue Manager loaded\"),e.default=t.QueueManager}(),self.queueManager=n.default}();\n//# sourceMappingURL=queueManager.js.map"},{"name":"onInstall","id":3,"type":"function","enabled":true,"code":"run_function('onLoad', undefined, 'QueueManager')"},{"name":"Queue Trigger","type":"trigger","enabled":true,"text":"^\\[System\\]: Added (.+) to your (.+) queue\\.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.track(args[1], args[2])"}],"id":4},{"name":"Queue Clear Trigger for Queue","type":"trigger","enabled":true,"text":"^\\[System\\]: Queued (.+) commands cleared.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.clear(args[1])"}],"id":5},{"name":"Queue Clear Trigger for All","type":"trigger","enabled":true,"text":"^\\[System\\]: All queued commands cleared.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.clear('all')"}],"id":6},{"name":"Queue Empy Trigger","type":"trigger","enabled":true,"text":"^You have no queued commands\\.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.clear('all')"}],"id":7},{"name":"Queue Prepend Trigger","type":"trigger","enabled":true,"text":"^\\[System\\]: Prepended (.+) to your (.+) queue\\.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.trackFirst(args[1], args[2])"}],"id":8},{"name":"Queue Replace Trigger","type":"trigger","enabled":true,"text":"^\\[System\\]: Replaced command #(\\d+) in the queue with (.+) command: (.+)\\.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.trackReplace(args[1], args[3], args[2])"}],"id":9},{"name":"Queue Insert Trigger","type":"trigger","enabled":true,"text":"^\\[System\\]: Inserted command #(\\d+) in the queue with (.+) command: (.+)\\.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.trackAt(args[1], args[3], args[2])"}],"id":10},{"name":"Queue Remove Trigger","type":"trigger","enabled":true,"text":"^\\[System\\]: Removed the command at position (\\d+) in your .+ queue\\.$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.trackRemove(args[1])"}],"id":11},{"name":"Queue Start List Trigger","type":"trigger","enabled":true,"text":"#   Queue                Command                                                 ","matching":"exact","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.clear('all')"}],"id":12},{"name":"Queue List Trigger","type":"trigger","enabled":true,"text":"^\\d+\\)\\s+(\\S+)\\s+(.+)$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.track(args[2], args[1])"}],"id":13},{"name":"Queue Run Trigger","type":"trigger","enabled":true,"text":"^\\[System\\]: Running queued (.+) command: (.+)$","matching":"regexp","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.run(args[2], args[1])"}],"id":14},{"name":"Queue Full","type":"trigger","enabled":true,"text":"[System]: Your queue is full.","matching":"exact","whole_words":true,"case_sensitive":true,"actions":[{"action":"script","script":"globalThis.queueManager.blocked()"}],"id":15}],"version":"0.0.3","dependencies":[],"website":"https://keneanung.github.io/nexus-misc-packages","id":1}